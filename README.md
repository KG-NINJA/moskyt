# むしよけ（デモ）

HTML/CSS/JS のみで動作する高周波トーンの実験アプリです。FM変調モード、投票（効いた/効かない/不明）、共有、リアルタイム集計（Firebase/ローカルフォールバック）に対応。防虫効果は科学的に保証しません。

## 使い方
- `index.html` をブラウザで開きます。
- 「通常トーン / 虫よけFM」を選択し、「再生開始」で音をON/OFF。
- 周波数（16–22kHz）・音量をスライダーで調整。
- 体感結果を「効いた / 効かない / 不明」でワンタップ投票。
- 「結果を共有」でハッシュタグ `#MosquitoTest2025` を含むテキストを共有（Web Share 非対応環境では自動コピー）。
- Firebase未設定時はローカル集計でチャートが動作します。

## リアルタイム集計（任意・Firebase）
1. `firebase-config.example.js` を `firebase-config.js` にコピーし、Firebaseコンソールの設定で値を埋める。
2. Firebaseで Firestore を有効化。
3. ルールは用途に合わせて設定してください（例: デモ用途の簡易ルール）
   ```
   rules_version = '2';
   service cloud.firestore {
     match /databases/{database}/documents {
       match /{document=**} {
         allow read, write: if true; // デモ用。必ず本番では制限してください
       }
     }
   }
   ```
4. 本アプリが使用するコレクション
   - `mosquitoVotes`（原票）
   - `mosquitoVotesAgg/global`（集計ドキュメント: { good, bad, unknown }）

注意: 本番では認証やCloud Functions等でサーバーサイド集計を推奨します。

## 構成
- `index.html` — UI（モード選択/投票/チャート/アニメ）
- `styles.css` — スタイル（ダークテーマ、投票チップ、蚊アニメ）
- `script.js` — 音声生成（トーン/FM）、投票、共有、集計（Chart.js / Firestore）
- `firebase-config.example.js` — Firebase設定の雛形

## 注意事項
- 一部デバイス／スピーカーは高周波を再生できません。
- 聴力保護のため音量は控えめに。
- 実際の防虫効果は保証しません（技術デモ）。
---

# 🦟 FM音源を使った蚊忌避音波の研究とアプリ実装

## 📌 概要

本プロジェクトは、**FM音源の倍音特性を利用して、蚊を忌避する音波を生成しようとする試み**です。世界的な音響データセット「HumBugDB」を活用し、Webブラウザ上で実際に音を生成・再生・実証するアプリを構築します。

## 🔍 背景

従来の「超音波で蚊を撃退する装置」は科学的に効果が否定されてきました。その主な理由は以下の通りです：

- 蚊の聴覚帯域外の周波数を使用している
- 個体差・種差によって効果が一定でない
- 慣れや適応が起こる

## 🧠 アイデアの再構成：FM音源による再挑戦

**FM音源（周波数変調音源）**は、複雑な倍音スペクトルを制御できる音源で、音楽的にも不協和音やうねりを作り出すのに長けています。これを蚊にとって「不快」な音として利用する可能性を探ります。

### 技術の利点

- 倍音を細かくコントロール可能
- 音のうねり・不協和を自由に設計可能
- ブラウザで再生可能（Tone.js + NexusUI）

## 🔬 使用する研究リソース

### HumBugDB
- 多種の蚊の羽音を収録した大規模データセット
- 音声ファイル＋年齢・性別・場所などのメタデータ付き
- GitHub & Zenodo にてコード・データセット公開  
  👉 [arXiv:2110.07607](https://arxiv.org/abs/2110.07607)  
  👉 [HumBugDB @ Zenodo](https://zenodo.org/record/4904800)

### 関連研究（arXiv）

| タイトル | リンク | 概要 |
|----------|--------|------|
| The Antenna Base Plays a Crucial Role in Mosquito Courtship Behavior | [arXiv:2112.10734](https://arxiv.org/abs/2112.10734) | 蚊の聴覚器官の非線形特性に関するモデル研究 |
| 3D audio-visual recordings of mosquito wings | [arXiv:2401.01026](https://arxiv.org/abs/2401.01026) | 蚊の羽音の3Dマッピングとシミュレーション研究 |
| HumBugDB Dataset Paper | [arXiv:2110.07607](https://arxiv.org/abs/2110.07607) | 大規模音響データセットと分類モデルの紹介 |

## 🛠️ 技術構成

| 技術 | 内容 |
|------|------|
| Tone.js | FM音源の実装用ライブラリ（Web Audio APIラッパー） |
| NexusUI | スライダーやノブなどのUI構築ライブラリ |
| GitHub Pages | ブラウザアプリのホスティングに使用 |
| FFTスペクトル比較 | 実音とFM合成音のスペクトルを比較し、違和感スコアを算出 |

## 🔁 研究プラン・ステップ

1. **HumBugDBの解析**
   - 蚊の羽音のスペクトル解析（種別・性別ごと）
2. **FM音源による音波設計**
   - 不協和倍音や変調深度の調整
3. **スペクトル比較による「違和感」音選定**
4. **GitHub Pagesにインタラクティブアプリを公開**
5. **実証実験**
   - ユーザーが自宅などで試し、蚊の行動変化を記録

## 🎓 将来展望

- FM音源で「学習可能な」忌避音波の自動生成モデルへ発展
- スマート家電・キャンプ機器などへの応用
- 論文化・arXiv投稿

## 📂 ライセンス

本プロジェクトのコード・データはMITライセンスで公開予定です。

---


